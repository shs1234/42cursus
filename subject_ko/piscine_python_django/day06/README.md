# **D06 - Piscine Python-Django**

## 회원 인증과 사용자

### "리빙 포인트" 사이트 프로젝트

_요약: 여러분을 권한과 유저 관리의 달인이 되게 해 줄 간단한 쟝고 프로젝트는 어떠세요?_

##### _번역 오류 및 오역 제보는 42seoul_club_translate 채널 또는 @jiychoi 로 연락주세요._

<br>

# Contents

| Chapter | Contents                                                                  | page |
| :-----: | :------------------------------------------------------------------------ | :--: |
|    1    | [**Preamble**](#Chapter-1)                                                |  2   |
|   1.1   | [**TREATY Of the fair art of crafting hyped addresses...**](#Chapter-1-1) |  2   |
|  1.1.1  | [**Thy spirit shalt model they craft...**](#Chapter-1-1-1)                |  2   |
|    2    | [**Instructions**](#Chapter-1)                                            |  3   |
|    3    | [**Exercise 00**](#Chapter-3)                                             |  4   |
|    4    | [**Exercise 01**](#Chapter-4)                                             |  5   |
|    5    | [**Exercise 02**](#Chapter-5)                                             |  7   |
|    6    | [**Exercise 03**](#Chapter-6)                                             |  8   |
|    7    | [**Exercise 04**](#Chapter-7)                                             |  10  |
|    8    | [**Exercise 05**](#Chapter-8)                                             |  11  |
|    9    | [**Exercise 06**](#Chapter-9)                                             |  12  |

<br>

# **Chapter 1**

## Preamble

다음 내용은 IP 주소를 만드는 고대의 방법을 언급하는 책에서 발췌하였습니다 :

# **Chapter 1 1**

## TREATY Of the fair art of crafting hyped addresses

In the present escript thou shalt find the true art so seldomly exposed of the hyped address crafting, like ancient ones were taught deep in the workshops of Stringth-on-Havenshire. Might god bless each and all that may some day tackle this heavenly and neglected matter, that many lacking the knowledge ended creating such improper addresses to the use of fair discussions.

As oftenly one might read or evently practice the craft of o damnadly modern addresses. In here shalt not this one be treated in such way that it produces seldomly used types of addresses, see you? Decaying and rotting such as flesh of ancient virgin maidens. Those explained in these very pages shalt resist unlike no other to the wear of time as well as the plague named of the ancient words Faillibus-aulniem, Altus-droopium filium.

Such as tedious craftmen shalt carefuly study the perfected virtue of setting tools and ingredients of trade without sparing to produce subtle and sharp addresses as deep and perfectly proportioned to reach a sovereign state of exchange.

# **Chapter 1 1 1**

## Thy spirit shalt model they craft

Or as wise Salomon used to speak, Sapience in no way can access one soiled spirit, thus the utter importance of the crafter’s influence over the crafted just like a mirror reflecting thy highest virtue. Hence only the fiercest and healthiest of craftsmen shalt be able to reach the highest level of this godly artsness.

# Chapter 2

## Instructions

노골적인 모순이 없는 이상, 해당 지침은 Python Django Piscine 모든 날짜에 적용됩니다.

- 이 페이지에 있는 내용만이 레퍼런스로 적용됩니다. 루머를 믿지 마세요!

- 조심하세요! 과제를 제출하기 한 시간 전까지도 해당 문서는 변경될 수 있습니다.

- 이번 과제들은 난이도별로 배치되어 있습니다 - 쉬운 것부터 어려운 것 까지요. 만약 쉬운 과제가 제대로 작동하지 않으면, `우리는 절 대` 어려운 과제를 (완벽하게 구현하였더라도) 채점하지 않을 것입니다.

- 파일과 디렉토리에 적절한 권한 설정을 해 주었는지 확인하세요.

- 각 과제별로 **제출 필수사항**을 지키셔야 합니다.

- 여러분의 과제는 같은 피씨너들에게 채점받고 점수가 매겨질 것입니다.

- 그리고 그 뒤에, 뮬리넷이라는 프로그램에 의해 채점되고 점수가 매겨질 것입니다. 뮬리넷은 여러분의 과제를 정말 엄격하고 꼼꼼하게 채점할 것입니다. 또한 모든 작업은 자동으로 진행되므로, 여러분이 뮬리넷과 협상하는 것은 불가능합니다. 좋지 못한 결과를 깜짝 선물로 받고 싶지 않다면, 철저히 과제에 임하세요.

- 쉘 과제들은 `/bin/sh`에 의해 실행될 수 있어야 합니다.

- 여러분은 **절대로** 명시된 제출 파일 외의 다른 파일들을 폴더 내에 남겨두시면 **안됩니다.**

- 질문 있으세요? 오른쪽 동료에게 물어보세요. 아니면 왼쪽 동료한테 물어보세요.

- 여러분이 참고할 만한 가이드는 `Google / man / 인터넷` 등이 있습니다.

- 인트라나 슬랙의 피씬 채널에서 토의하는 것을 잊지 마세요!

- 예시를 꼼꼼히 살펴보세요. 과제에 명시되지 않은 상세한 부분들이 들어있을 수도 있으니까요..

<br>

# Chapter 3

## Exercise 00

<br>

| **Piscine**             | Exercise 00                                             |
| ----------------------- | ------------------------------------------------------- |
| Exercise 00 : 익명 세션 |
| **제출할 폴더**         | ex/                                                     |
| **제출할 파일**         | `requirements.txt, 여러분의 프로젝트`                   |
| **허용되는 함수**       | `모든 쟝고 기능들 사용 가능, random, django-bootstrap3` |

<br>

여러분은 지금부터 "리빙 포인트" 들을 게시할 수 있는 웹사이트를 만드는 프로젝트를 진행할 겁니다.

프로젝트와 어플리케이션을 생성하고 홈페이지 URL을 `/` 으로 설정해 둔 후, 다음과 같은 익명 세션 기능을 구현하세요:

- 여러분의 사이트에 방문하는 웹 유저들은 유저명을 가질 수 있습니다. 해당 유저명은 여러분이 `settings.py`에 정의한 리스트 내의 10개의 단어들 중 랜덤으로 배정되며, 해당 인증은 42초동안만 유효합니다.

- 유저명은 지속적이어야 하고 42초동안 똑같은 이름이 남아있어야 합니다. 42초가 지나면, 앞서 설명했듯 이름이 랜덤하게 재정의되어야 합니다.

- 구현한 동작을 메시지와 함께 `<nav>` 원소를 이용해 표시함으로서 돋보이게 하세요. 이 메시지는 간단하게 "Hello user!" 에서 `user`를 현재 세션에서 유효한 이름으로 대치한 문구면 됩니다.

- 페이지에 접속하자마자 이름이 표시되어야 합니다. 이름을 표시하기 위해 새로고침이 필요하다면, 과제를 미완성한 것과 다름없어요!

<br>

# Chapter 4

## Exercise 01

<br>

| **Piscine**             | Exercise 01                                     |
| ----------------------- | ----------------------------------------------- |
| Exercise 01 : 유저 생성 |
| **제출할 폴더**         | ex/                                             |
| **제출할 파일**         | `requirements.txt, 여러분의 프로젝트`           |
| **허용되는 함수**       | `모든 쟝고 기능들 사용 가능, django-bootstrap3` |

<br>

익명 사용자 세션 시스템을 구현했으니, 이제 유저 생성과 인증 인터페이스를 통한 유저 관리 기능을 추가해봅시다.

해당 과제에선, 다음과 같은 인터페이스를 단계별로 하나씩 만들어 봅니다:

- 회원가입 페이지와 로그인 페이지를 추가하는 것으로 과제를 시작하세요. 해당 페이지로 진입할 수 있는 링크를 직전 과제에서 만든 `<nav>` 원소에 추가하세요. 그리고 필요한 url과 템플릿, 뷰 등을 추가하세요.

  `<nav>`에 사이트의 이름을 추가하고 홈페이지로 향하는 링크를 붙여넣어도 좋습니다.

- 해당 페이지에 추가할 폼들을 만드세요. 다음과 같은 특성을 가져야 합니다:

  - **회원가입 폼**:

    - 3개의 서로 다른 필드를 만듭니다 :

      - 유저명 (Username) 필드

      - 비밀번호 필드

      - 비밀번호 확인 필드

    - 각 필드가 적절하게 채워지고, 유저명이 중복되지 않았으며, 비밀번호와 비밀번호 확인 필드의 값이 똑같을 때에만 인증이 진행됩니다.

  - **로그인 폼**:

    - 2개의 서로 다른 필드를 만듭니다 :

      - 유저명 필드

      - 비밀번호 필드

    - 각 필드가 적절하게 채워지고, 해당 유저명과 패스워드 쌍이 데이터베이스에 존재하여 식별이 가능할 때에만 인증이 진행됩니다.

- 이제, 페이지에 다음과 같은 기능을 추가하세요:

  - 데이터 검증 시에:

    **회원가입**: 입력받은 정보를 통한 유저 생성 및 활성화. 또한 해당 유저 계정으로 연결된 후 홈페이지로 리디렉션되게 하세요.

    **연결**: 입력받은 정보에 맞는 유저 계정으로 연결된 후, 홈페이지로 리디렉션되게 하세요.

  - 데이터 검증이 아닐 때에:

    다음 케이스에선, 어떤 경우에든 방금 전에 입력받은 데이터 (패스워드 제외) 가 그대로 포함된 채로 폼을 다시 보여주어야 합니다.

    **회원가입**: 한 개 이상의 에러 메시지를 에러 설명과 함께 표시 (필수 입력 항목을 채우지 않았거나, 이미 존재하는 유저명이거나, 패스워드가 맞지 않을 때)

    **로그인**: 에러 메시지를 폼과 함께 표시 (필수 입력 항목을 채우지 않았거나, 로그인 정보가 맞지 않을 때)

- 그리고, 유저가 로그인되었을 때에,

  - 회원가입과 로그인 링크는 로그아웃 링크 (당연히 작동되어야 합니다.) 로 치환되어야 하고, 해당 링크를 눌렀을 때 유저가 로그아웃된 후 홈페이지로 리디렉션되어야 합니다.

  - `nav` 원소에서 표시되던 익명 유저 세션의 이름은 로그인된 유저명으로 대체되어야 합니다.

  - 로그인된 상태에서는 회원가입 페이지와 로그인 페이지에 접근할 수 없어야 합니다. 접근을 시도하면, 홈페이지로 리디렉션되어야 합니다.

- 당연히, 패스워드를 입력 중에는 패스워드가 가려져야 합니다.

> 💡 <br>
> 다른 과제에서 여러분은 직접 유저 클래스를 제작하여, 쟝고에서 제공하는 기본 유저 클래스를 대체할 것입니다. <br> 이를 염두에 두고 현명하게 프로젝트를 진행하는 것이 여러분의 유저 클래스를 매번 다시 작성할 필요가 없어 편리할 것입니다. (필수는 아니지만요)

<br>

# Chapter 5

## Exercise 02

<br>

| **Piscine**                  | Exercise 02                                     |
| ---------------------------- | ----------------------------------------------- |
| Exercise 02 : 리빙 포인트들! |
| **제출할 폴더**              | ex/                                             |
| **제출할 파일**              | `requirements.txt, 여러분의 프로젝트`           |
| **허용되는 함수**            | `모든 쟝고 기능들 사용 가능, django-bootstrap3` |

<br>

드디어 우리들의 프로젝트에 핵심 요소를 넣을 순간이 왔습니다 : 리빙 포인트 말이죠!

이를 위해서, 다음과 같은 요소가 포함된 `Tip` 모델을 생성하도록 합시다:

- 리빙 포인트 내용이 담긴 `content` 필드 (당연히 텍스트 폼이지요)

- `author` 필드 (글을 게시한 작성자가 들어가는 부분입니다)

- `date` 필드 (글의 게시 날짜가 들어갑니다)

작성한 리빙 포인트 게시물들은 홈페이지에 리스트로 표시되어야 하고, 해당 과제에 언급된 모든 속성들이 함께 표시되어야 합니다.

로그인한 상태에서, 유저는 해당 폼 세트를 이용하여 홈페이지에서 게시글을 작성할 수 있어야 합니다. (`modelform`을 사용하세요!!)

유저가 로그인하지 않은 상태라면, 게시글 작성 폼이 표시되면 안 되고, 게시글을 작성할 수 있어도 안 됩니다.

<br>

# Chapter 6

## Exercise 03

<br>

| **Piscine**               | Exercise 03                                     |
| ------------------------- | ----------------------------------------------- |
| Exercise 03 : 추천 비추천 |
| **제출할 폴더**           | ex/                                             |
| **제출할 파일**           | `requirements.txt, 여러분의 프로젝트`           |
| **허용되는 함수**         | `모든 쟝고 기능들 사용 가능, django-bootstrap3` |

<br>

게시글 작성 시스템이 구현되었네요! 이왕 이렇게 된 김에 좋은 글들을 골라내는 기능도 추가하면 좋을 것 같아요. 맞아요, 추천 / 비추천 기능을 추가할 차례입니다!

해당 기능을 추가하기 위해서, `Tip` 모델을 조금 손볼 필요가 있습니다.

쓸모없는 리빙 포인트를 삭제하기 위한 기능도 추가해야 합니다.

다음과 같은 요소들을 홈페이지에 나열된 게시물들에 추가하세요:

- 삭제 버튼

- 추천 버튼

- 비추천 버튼

- 추천받은 횟수 표시

- 비추천 횟수 표시

추가할 기능들에 대한 제약사항이라면, 추천 / 비추천을 누르기 위해서는 로그인이 되어있어야 한다는 점입니다. 만약 유저가 로그인되지 않았다면, 해당 기능들은 비활성화되어야 합니다.

각 기능들은 페이지를 리로드합니다.

당연하지만, 갓 생성된 게시물 (`Tip`) 은 추천 수 / 비추천 수가 0이어야 합니다.

**주의사항**:

- 같은 게시물에 추천과 비추천을 동시에 누를 수 없습니다.

- 유저는 한 게시물에 추천 또는 비추천을 딱 한 번만 누를 수 있습니다. 같은 버튼을 한 번 더 누를 경우, 이전의 추천 / 비추천을 취소합니다.

- 만약 유저가 이미 추천을 눌렀던 게시물에 비추천을 누를 경우, 추천은 사라지고 비추천으로 대체됩니다. (그 반대도 동일하게 동작하여야 합니다.)

> ⚠ <br>
> 여러분이 추가한 추천 / 비추천 시스템을 주의깊게 살펴보세요. 누른 추천 / 비추천이 지속적이지 않거나, 주의사항을 하나라도 지키지 않았을 경우 (추천을 취소했을 때 추천 갯수가 줄어들지 않는다던가 등) 과제는 무효 처리됩니다. 추천 / 비추천 기능을 구현할 때, counters 대신 manytomany 필드를 사용하는 것을 고려하는 것이 좋습니다.

이 과제에서, 모든 기능들은 유저가 로그인되어 있을 때에만 동작하여야 합니다.

유저의 상태에 따라 기능이 적절히 활성화되거나, 비활성화되도록 구현하셔야 합니다.

<br>

# Chapter 7

## Exercise 04

<br>

| **Piscine**                             | Exercise 04                                     |
| --------------------------------------- | ----------------------------------------------- |
| Exercise 04 : 기본적인 권한 부여의 사용 |
| **제출할 폴더**                         | ex/                                             |
| **제출할 파일**                         | `requirements.txt, 여러분의 프로젝트`           |
| **허용되는 함수**                       | `모든 쟝고 기능들 사용 가능, django-bootstrap3` |

<br>

프로젝트가 꽤나 본격적으로 진행되면서, 유저가 로그인되어 있는 한 누구든 모든 기능을 사용할 수 있음을 눈치챘습니다. 이제 제약사항을 조금 넣을 때가 왔어요.

지금부터, 유저가 게시물을 삭제하고... 싶다면 게시글 삭제 권한이 필요합니다.

쟝고에서 기본적으로 제공되는 권한 (Administration) 인터페이스를 활성화시키고, 관리자 (슈퍼유저) 를 사용하여 프로젝트 내의 각 기능들에 대한 권한과 동작 여부를 표시하도록 합시다.

당연히, "삭제" 버튼을 페이지에서 지워버리는 것보다 더 많은 것을 적용하여야 합니다. (뭐, 버튼을 지우라면 여러분도 쉽게 지울 수 있겠지요) 기능 사용을 위한 권한 체크를 진행하는 올바른 방법을 찾아 적용해보세요.

**주의**: 당연히, 게시글의 작성자는 본인의 게시물을 원한다면 마음껏 지울 수 있습니다. 이번 과제에서의 유일한 예외사항이에요.

<br>

# Chapter 8

## Exercise 05

<br>

| **Piscine**                  | Exercise 05                                     |
| ---------------------------- | ----------------------------------------------- |
| Exercise 05 : 개인 권한 설정 |
| **제출할 폴더**              | ex/                                             |
| **제출할 파일**              | `requirements.txt, 여러분의 프로젝트`           |
| **허용되는 함수**            | `모든 쟝고 기능들 사용 가능, django-bootstrap3` |

<br>

'비추천' 에서 느껴지는 부정적인 어감에서도 알 수 있듯이, 이 또한 특정 유저들만 사용 가능하도록 제약을 두는 것이 적절할 것 같습니다.

방금 전의 과제에서 구현했던 기능들을 비추천 기능에도 적용하세요.

이 권한은 이미 기본적으로 제공되는 권한이 아니기 때문에, 적절하지 못한 권한을 설정하여 사용하는 것은 조금 어리석은 행동이 될 수도 있습니다. 비추천 기능을 사용하기 위한 적절한 권한을 직접 만들어보세요!

직전 과제와 마찬가지로, 비추천 버튼을 삭제하라는 얘기가 아닙니다. 물론 시도는 해 볼 수 있겠죠? 성공은 보장 못하지만요.

**주의**: 게시글 삭제 때와 마찬가지로, 게시글 작성자는 자신의 게시글에 비추천을 누를 수 있습니다. 뭐, 본인이 스스로가 작성한 글이 바보같다고 생각한다면요.

<br>

# Chapter 9

## Exercise 06

<br>

| **Piscine**                  | Exercise 06                                     |
| ---------------------------- | ----------------------------------------------- |
| Exercise 06 : 자동화 및 평판 |
| **제출할 폴더**              | ex/                                             |
| **제출할 파일**              | `requirements.txt, 여러분의 프로젝트`           |
| **허용되는 함수**            | `모든 쟝고 기능들 사용 가능, django-bootstrap3` |

<br>

프로젝트를 위한 대부분의 기능 구현이 끝났습니다. 직접 모든 권한들을 관리할 필요가 없다는 것은 크나큰 이점이죠! 몇몇 사이트들은 회원 개인의 평판에 따라 특별한 권한을 주는 등의 시스템을 적용하기도 합니다. 이러한 시스템은 특정 조건을 만족한 유저들에게 새로운 기능을 사용할 수 있는 특권을 주기도 하죠! 이것이 이번 과제에서 구현할 내용입니다. 유저가 작성한 게시물에 달린 추천의 수만큼 평판을 쌓을 수 있는 시스템을 만들어 보세요.

기존에 사용하던 유저 클래스를 직접 만든 유저 클래스로 대체하세요. 해당 클래스에서는, 유저의 평판에 따라 비추천을 누르거나 게시물을 삭제할 수 있는 권한을 제공할 수 있도록 구현하여야 합니다. 유저의 평판은 유저가 지금까지 작성한 게시물에 달린 추천 / 비추천의 수에 따라 결정됩니다.

새로운 유저는 평판 포인트 0부터 시작합니다. 유저의 게시물에 달린 추천 1마다 평판 포인트가 5씩 증가합니다. 반면, 비추천 1마다 평판 포인트가 2씩 감소합니다. 게시물이 삭제될 경우, 해당 게시물에서 얻거나 잃었던 평판 포인트들 또한 삭제됩니다.

유저는 평판 포인트 15를 달성했을 때 비추천 권한을 해금할 수 있습니다. 게시물을 삭제하는 권한은 평판 포인트 30에 해금됩니다. 평판 포인트가 기준치보다 떨어지면, 해당 권한들은 다시 사용불가 상태로 돌아갑니다.

페이지에 표시되는 유저명 옆에 그들의 명성 포인트를 (괄호로 감싸서) 표시해야 합니다.
